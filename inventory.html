<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory Management - EPSA Pharmaceutical System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Inter', sans-serif; }
        body { 
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            min-height: 100vh;
        }
        .nav-link {
            position: relative;
            transition: color 0.3s ease;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 0;
            height: 2px;
            background: #3282B8;
            transition: width 0.3s ease;
        }
        .nav-link:hover::after,
        .nav-link.active::after {
            width: 100%;
        }
        .search-container {
            position: relative;
        }
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            z-index: 10;
            max-height: 200px;
            overflow-y: auto;
        }
        .table-row {
            transition: all 0.2s ease;
        }
        .table-row:hover {
            background-color: #f9fafb;
            transform: scale(1.01);
        }
        .stock-level-good { color: #059669; background-color: #d1fae5; }
        .stock-level-warning { color: #d97706; background-color: #fef3c7; }
        .stock-level-critical { color: #dc2626; background-color: #fee2e2; }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .notification-badge {
            animation: bounce 1s infinite;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
    </style>
</head>
<body>
    <!-- Navigation Header -->
    <nav class="bg-white/95 backdrop-blur-md border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-8">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-gradient-to-br from-teal-500 to-blue-600 rounded-lg flex items-center justify-center">
                            <span class="text-white font-bold text-sm">EP</span>
                        </div>
                        <span class="text-xl font-bold text-gray-900">EPSA Pharma System</span>
                    </div>
                    <div class="hidden md:flex space-x-6">
                        <a href="index.html" class="nav-link text-gray-600 hover:text-gray-900 font-medium">Dashboard</a>
                        <a href="inventory.html" class="nav-link active text-gray-900 font-medium">Inventory</a>
                        <a href="expiry.html" class="nav-link text-gray-600 hover:text-gray-900 font-medium">Expiry Tracking</a>
                        <a href="orders.html" class="nav-link text-gray-600 hover:text-gray-900 font-medium">Orders</a>
                        <a href="reports.html" class="nav-link text-gray-600 hover:text-gray-900 font-medium">Reports</a>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <button class="p-2 text-gray-600 hover:text-gray-900 relative">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5-5-5h5v-12"></path>
                            </svg>
                            <span class="notification-badge absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">2</span>
                        </button>
                    </div>
                    <div class="flex items-center space-x-3">
                        <img src="resources/team-1.jpg" alt="User" class="w-8 h-8 rounded-full object-cover">
                        <div class="hidden md:block">
                            <p class="text-sm font-medium text-gray-900">Dr. Sarah Johnson</p>
                            <p class="text-xs text-gray-500">System Administrator</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <section class="py-8 bg-gradient-to-r from-teal-50 to-blue-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-gray-900">Inventory Management</h1>
                    <p class="text-gray-600 mt-2">Manage pharmaceutical inventory across all warehouses</p>
                </div>
                <div class="flex space-x-3">
                    <button id="add-medicine-btn" class="bg-gradient-to-r from-teal-600 to-blue-600 text-white px-6 py-2 rounded-lg font-semibold hover:shadow-lg transition-all duration-300">
                        Add Medicine
                    </button>
                    <button class="border border-gray-300 text-gray-700 px-6 py-2 rounded-lg font-semibold hover:bg-gray-50 transition-all duration-300">
                        Export Data
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Search and Filters -->
    <section class="py-6">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="search-container">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Search Medicine</label>
                        <input type="text" id="medicine-search" placeholder="Search by name, ID, or category..." 
                               class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        <div id="search-results" class="search-results hidden"></div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
                        <select id="category-filter" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                            <option value="">All Categories</option>
                            <option value="Analgesic">Analgesic</option>
                            <option value="Antibiotic">Antibiotic</option>
                            <option value="NSAID">NSAID</option>
                            <option value="Antidiabetic">Antidiabetic</option>
                            <option value="ACE Inhibitor">ACE Inhibitor</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Warehouse</label>
                        <select id="warehouse-filter" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                            <option value="">All Warehouses</option>
                            <option value="Central">Central Warehouse</option>
                            <option value="Regional">Regional Warehouse</option>
                            <option value="District">District Storage</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Stock Status</label>
                        <select id="stock-filter" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                            <option value="">All Status</option>
                            <option value="good">Good Stock</option>
                            <option value="low">Low Stock</option>
                            <option value="critical">Critical Stock</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Inventory Table -->
    <section class="py-6">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200">
                    <div class="flex items-center justify-between">
                        <h3 class="text-lg font-semibold text-gray-900">Medicine Inventory</h3>
                        <div class="flex items-center space-x-4">
                            <span class="text-sm text-gray-500">Total: <span id="total-count">0</span> medicines</span>
                            <div class="flex space-x-2">
                                <button id="grid-view" class="p-2 text-gray-600 hover:text-gray-900 rounded-md">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path>
                                    </svg>
                                </button>
                                <button id="list-view" class="p-2 text-teal-600 bg-teal-100 rounded-md">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortTable('id')">
                                    Medicine ID
                                    <svg class="w-4 h-4 inline ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path>
                                    </svg>
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortTable('name')">
                                    Medicine Name
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Warehouse</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortTable('stock')">
                                    Current Stock
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Expiry Date</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="inventory-table" class="bg-white divide-y divide-gray-200">
                            <!-- Table rows will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Add Medicine Modal -->
    <div id="add-medicine-modal" class="modal">
        <div class="bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-lg font-semibold text-gray-900">Add New Medicine</h3>
                <button id="close-modal" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <form id="add-medicine-form" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Medicine Name</label>
                    <input type="text" id="medicine-name" required 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                    <select id="medicine-category" required 
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        <option value="">Select Category</option>
                        <option value="Analgesic">Analgesic</option>
                        <option value="Antibiotic">Antibiotic</option>
                        <option value="NSAID">NSAID</option>
                        <option value="Antidiabetic">Antidiabetic</option>
                        <option value="ACE Inhibitor">ACE Inhibitor</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Initial Stock</label>
                    <input type="number" id="initial-stock" required min="1"
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Warehouse</label>
                    <select id="medicine-warehouse" required 
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        <option value="">Select Warehouse</option>
                        <option value="Central">Central Warehouse</option>
                        <option value="Regional">Regional Warehouse</option>
                        <option value="District">District Storage</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Expiry Date</label>
                    <input type="date" id="expiry-date" required 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                </div>
                
                <div class="flex space-x-3 pt-4">
                    <button type="submit" class="flex-1 bg-gradient-to-r from-teal-600 to-blue-600 text-white py-2 px-4 rounded-lg font-semibold hover:shadow-lg transition-all duration-300">
                        Add Medicine
                    </button>
                    <button type="button" id="cancel-add" class="flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded-lg font-semibold hover:bg-gray-50 transition-all duration-300">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-8 mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <p class="text-sm text-gray-400">Â© 2025 EPSA Pharmaceutical Management System. All rights reserved.</p>
                <p class="text-xs text-gray-500 mt-2">Ethiopian Pharmaceutical Supply Agency</p>
            </div>
        </div>
    </footer>

    <script src="main.js"></script>
    <script>
        // Inventory-specific functionality
        let inventoryData = [];
        let filteredData = [];
        let currentSort = { field: 'id', direction: 'asc' };

        // Initialize inventory page
        document.addEventListener('DOMContentLoaded', function() {
            initializeInventoryPage();
        });

        function initializeInventoryPage() {
            generateMockInventoryData();
            renderInventoryTable();
            initializeFilters();
            initializeModal();
            
            // Animate page elements
            anime({
                targets: '.bg-white',
                translateY: [20, 0],
                opacity: [0, 1],
                duration: 800,
                delay: anime.stagger(100),
                easing: 'easeOutCubic'
            });
        }

        function generateMockInventoryData() {
            const medicines = [
                'Paracetamol 500mg', 'Amoxicillin 250mg', 'Ibuprofen 400mg', 'Metformin 500mg', 'Lisinopril 10mg',
                'Aspirin 100mg', 'Omeprazole 20mg', 'Atorvastatin 20mg', 'Levothyroxine 50mcg', 'Simvastatin 40mg',
                'Losartan 50mg', 'Amlodipine 5mg', 'Metoprolol 25mg', 'Prednisone 5mg', 'Tramadol 50mg'
            ];
            
            const categories = ['Analgesic', 'Antibiotic', 'NSAID', 'Antidiabetic', 'ACE Inhibitor', 'Anticoagulant', 'PPI', 'Statin', 'Hormone', 'Antihypertensive'];
            const warehouses = ['Central', 'Regional', 'District'];
            
            inventoryData = medicines.map((medicine, index) => {
                const stock = Math.floor(Math.random() * 15000) + 1000;
                const expiryDate = new Date();
                expiryDate.setMonth(expiryDate.getMonth() + Math.floor(Math.random() * 24) + 6);
                
                return {
                    id: `MED${String(index + 1).padStart(3, '0')}`,
                    name: medicine,
                    category: categories[Math.floor(Math.random() * categories.length)],
                    warehouse: warehouses[Math.floor(Math.random() * warehouses.length)],
                    stock: stock,
                    expiry: expiryDate.toISOString().split('T')[0],
                    status: stock > 10000 ? 'good' : stock > 5000 ? 'low' : 'critical'
                };
            });
            
            filteredData = [...inventoryData];
            updateTotalCount();
        }

        function renderInventoryTable() {
            const tbody = document.getElementById('inventory-table');
            tbody.innerHTML = '';
            
            filteredData.forEach((medicine, index) => {
                const row = document.createElement('tr');
                row.className = 'table-row';
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${medicine.id}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${medicine.name}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${medicine.category}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${medicine.warehouse} Warehouse</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900">${medicine.stock.toLocaleString()}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${formatDate(medicine.expiry)}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 py-1 text-xs font-semibold rounded-full ${getStockStatusClass(medicine.status)}">
                            ${getStockStatusText(medicine.status)}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button class="text-teal-600 hover:text-teal-900 mr-3" onclick="viewMedicine('${medicine.id}')">View</button>
                        <button class="text-blue-600 hover:text-blue-900 mr-3" onclick="editMedicine('${medicine.id}')">Edit</button>
                        <button class="text-red-600 hover:text-red-900" onclick="deleteMedicine('${medicine.id}')">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
                
                // Animate row appearance
                anime({
                    targets: row,
                    translateX: [-20, 0],
                    opacity: [0, 1],
                    duration: 400,
                    delay: index * 50,
                    easing: 'easeOutCubic'
                });
            });
        }

        function initializeFilters() {
            const searchInput = document.getElementById('medicine-search');
            const categoryFilter = document.getElementById('category-filter');
            const warehouseFilter = document.getElementById('warehouse-filter');
            const stockFilter = document.getElementById('stock-filter');
            
            searchInput.addEventListener('input', debounce(applyFilters, 300));
            categoryFilter.addEventListener('change', applyFilters);
            warehouseFilter.addEventListener('change', applyFilters);
            stockFilter.addEventListener('change', applyFilters);
            
            // Search autocomplete
            searchInput.addEventListener('focus', showSearchSuggestions);
            searchInput.addEventListener('blur', hideSearchSuggestions);
        }

        function applyFilters() {
            const searchTerm = document.getElementById('medicine-search').value.toLowerCase();
            const category = document.getElementById('category-filter').value;
            const warehouse = document.getElementById('warehouse-filter').value;
            const stockStatus = document.getElementById('stock-filter').value;
            
            filteredData = inventoryData.filter(medicine => {
                const matchesSearch = !searchTerm || 
                    medicine.id.toLowerCase().includes(searchTerm) ||
                    medicine.name.toLowerCase().includes(searchTerm) ||
                    medicine.category.toLowerCase().includes(searchTerm);
                
                const matchesCategory = !category || medicine.category === category;
                const matchesWarehouse = !warehouse || medicine.warehouse === warehouse;
                const matchesStock = !stockStatus || medicine.status === stockStatus;
                
                return matchesSearch && matchesCategory && matchesWarehouse && matchesStock;
            });
            
            renderInventoryTable();
            updateTotalCount();
        }

        function showSearchSuggestions() {
            const searchResults = document.getElementById('search-results');
            const searchTerm = document.getElementById('medicine-search').value.toLowerCase();
            
            if (!searchTerm) {
                const suggestions = inventoryData.slice(0, 5);
                searchResults.innerHTML = suggestions.map(medicine => `
                    <div class="p-2 hover:bg-gray-100 cursor-pointer" onclick="selectMedicine('${medicine.name}')">
                        ${medicine.name} - ${medicine.id}
                    </div>
                `).join('');
                searchResults.classList.remove('hidden');
            }
        }

        function hideSearchSuggestions() {
            setTimeout(() => {
                document.getElementById('search-results').classList.add('hidden');
            }, 200);
        }

        function selectMedicine(medicineName) {
            document.getElementById('medicine-search').value = medicineName;
            document.getElementById('search-results').classList.add('hidden');
            applyFilters();
        }

        function sortTable(field) {
            if (currentSort.field === field) {
                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.field = field;
                currentSort.direction = 'asc';
            }
            
            filteredData.sort((a, b) => {
                let aVal = a[field];
                let bVal = b[field];
                
                if (field === 'stock') {
                    aVal = parseInt(aVal);
                    bVal = parseInt(bVal);
                }
                
                if (currentSort.direction === 'asc') {
                    return aVal > bVal ? 1 : -1;
                } else {
                    return aVal < bVal ? 1 : -1;
                }
            });
            
            renderInventoryTable();
        }

        function initializeModal() {
            const addBtn = document.getElementById('add-medicine-btn');
            const modal = document.getElementById('add-medicine-modal');
            const closeBtn = document.getElementById('close-modal');
            const cancelBtn = document.getElementById('cancel-add');
            const form = document.getElementById('add-medicine-form');
            
            addBtn.addEventListener('click', () => {
                modal.classList.add('show');
                anime({
                    targets: modal.querySelector('.bg-white'),
                    scale: [0.8, 1],
                    opacity: [0, 1],
                    duration: 300,
                    easing: 'easeOutCubic'
                });
            });
            
            [closeBtn, cancelBtn].forEach(btn => {
                btn.addEventListener('click', () => {
                    modal.classList.remove('show');
                });
            });
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('show');
                }
            });
            
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                addNewMedicine();
            });
        }

        function addNewMedicine() {
            const name = document.getElementById('medicine-name').value;
            const category = document.getElementById('medicine-category').value;
            const stock = parseInt(document.getElementById('initial-stock').value);
            const warehouse = document.getElementById('medicine-warehouse').value;
            const expiry = document.getElementById('expiry-date').value;
            
            const newMedicine = {
                id: `MED${String(inventoryData.length + 1).padStart(3, '0')}`,
                name: name,
                category: category,
                warehouse: warehouse,
                stock: stock,
                expiry: expiry,
                status: stock > 10000 ? 'good' : stock > 5000 ? 'low' : 'critical'
            };
            
            inventoryData.push(newMedicine);
            applyFilters();
            
            document.getElementById('add-medicine-modal').classList.remove('show');
            document.getElementById('add-medicine-form').reset();
            
            EPSA.showNotification(`${name} added successfully!`, 'success');
        }

        function viewMedicine(id) {
            const medicine = inventoryData.find(m => m.id === id);
            if (medicine) {
                EPSA.showNotification(`Viewing details for ${medicine.name}`, 'info');
            }
        }

        function editMedicine(id) {
            EPSA.showNotification('Edit functionality coming soon!', 'info');
        }

        function deleteMedicine(id) {
            if (confirm('Are you sure you want to delete this medicine?')) {
                const index = inventoryData.findIndex(m => m.id === id);
                if (index > -1) {
                    inventoryData.splice(index, 1);
                    applyFilters();
                    EPSA.showNotification('Medicine deleted successfully!', 'success');
                }
            }
        }

        function updateTotalCount() {
            document.getElementById('total-count').textContent = filteredData.length;
        }

        function getStockStatusClass(status) {
            const classes = {
                'good': 'stock-level-good',
                'low': 'stock-level-warning',
                'critical': 'stock-level-critical'
            };
            return classes[status] || 'bg-gray-100 text-gray-800';
        }

        function getStockStatusText(status) {
            const texts = {
                'good': 'Good',
                'low': 'Low Stock',
                'critical': 'Critical'
            };
            return texts[status] || 'Unknown';
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric' 
            });
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
    </script>
</body>
</html>